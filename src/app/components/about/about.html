<div class="about-container">

  <!-- Hero -->
  <div class="about-hero">
    <div class="about-logo-ring">
      <img [src]="config.appIcon" [alt]="config.appName" class="about-logo" />
    </div>
    <h1 class="about-app-name">{{ config.appName }}</h1>
    <div class="about-badges">
      <span class="badge badge-version">
        <mat-icon class="badge-icon" aria-hidden="true">tag</mat-icon>
        v{{ config.appVersion }}
      </span>
      <span class="badge badge-build">
        <mat-icon class="badge-icon" aria-hidden="true">build_circle</mat-icon>
        {{ config.appSubversion }}
      </span>
    </div>
  </div>

  <mat-divider />

  <!-- Tech Stack -->
  <section class="about-section">
    <h2 class="about-section-title">
      <mat-icon aria-hidden="true">layers</mat-icon>
      Built with
    </h2>
    <div class="tech-grid">
      @for (tech of techStack; track tech.name) {
        <div class="tech-card">
          <img [src]="tech.icon" [alt]="tech.name" class="tech-icon" />
          <span class="tech-name">{{ tech.name }}</span>
        </div>
      }
    </div>
  </section>

  <mat-divider />

  <!-- Info -->
  <section class="about-section">
    <h2 class="about-section-title">
      <mat-icon aria-hidden="true">info</mat-icon>
      Information
    </h2>
    <div class="info-grid">
      <div class="info-row">
        <span class="info-label">Application</span>
        <span class="info-value">{{ config.appName }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Platform</span>
        <span class="info-value">CK Platform</span>
      </div>
      <div class="info-row">
        <span class="info-label">Version</span>
        <span class="info-value">{{ config.appVersion }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Build</span>
        <span class="info-value">{{ config.appSubversion }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">Angular</span>
        <span class="info-value">v{{ angularVersion }}</span>
      </div>
    </div>
  </section>

  <mat-divider />

  <!-- DEBUG PANEL: shown only when preload failed -->
  @if (!debugInfo.hasApi) {
  <section class="about-section debug-panel m-4 rounded-lg">
    <h2 class="about-section-title">
      <mat-icon aria-hidden="true">bug_report</mat-icon>
      Debug Info
    </h2>
    <div class="info-grid">
      <div class="info-row">
        <span class="info-label">window</span>
        <span class="info-value">{{ debugInfo.hasWindow }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">electronAPI</span>
        <span class="info-value">{{ debugInfo.hasApi }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">API keys</span>
        <span class="info-value">{{ debugInfo.apiKeys.join(', ') || '(none)' }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">preloadStep</span>
        <span class="info-value">{{ debugInfo.preloadStep }}</span>
      </div>
      @if (debugInfo.preloadError) {
        <div class="info-row">
          <span class="info-label">preloadError</span>
          <span class="info-value info-value--wrap debug-error">{{ debugInfo.preloadError }}</span>
        </div>
      }
      <div class="info-row">
        <span class="info-label">systemInfo</span>
        <span class="info-value">{{ systemInfo() ? 'loaded' : 'null' }}</span>
      </div>
      <div class="info-row">
        <span class="info-label">userAgent</span>
        <span class="info-value info-value--wrap">{{ debugInfo.userAgent }}</span>
      </div>
      @if (preloadDebug(); as pd) {
        <div class="info-row">
          <span class="info-label">preload path</span>
          <span class="info-value info-value--wrap">{{ pd.preloadPath }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">preload exists</span>
          <span class="info-value">{{ pd.preloadExists }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">resourcesPath</span>
          <span class="info-value info-value--wrap">{{ pd.resourcesPath }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">log path</span>
          <span class="info-value info-value--wrap">{{ pd.logPath }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">log</span>
          <span class="info-value info-value--wrap debug-log">{{ pd.logContent }}</span>
        </div>
      }
    </div>
  </section>
  }

  <mat-divider />

  <!-- System Info (Electron only) -->
  @if (systemInfo(); as sys) {

    <!-- Computer -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">computer</mat-icon>
        Computer
      </h2>
      <div class="info-grid">
        <div class="info-row">
          <span class="info-label">Hostname</span>
          <span class="info-value">{{ sys.computer.hostname }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">OS</span>
          <span class="info-value">{{ sys.computer.os }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Platform</span>
          <span class="info-value">{{ sys.computer.platform }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Architecture</span>
          <span class="info-value">{{ sys.computer.arch }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Uptime</span>
          <span class="info-value">{{ formatUptime(sys.computer.uptime) }}</span>
        </div>
      </div>
    </section>

    <mat-divider />

    <!-- CPU -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">memory</mat-icon>
        CPU
      </h2>
      <div class="info-grid">
        <div class="info-row">
          <span class="info-label">Model</span>
          <span class="info-value info-value--wrap">{{ sys.cpu.model }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Cores</span>
          <span class="info-value">{{ sys.cpu.cores }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Speed</span>
          <span class="info-value">{{ sys.cpu.speed }} MHz</span>
        </div>
        <div class="info-row info-row--bar">
          <span class="info-label">Usage</span>
          <div class="resource-bar-wrap" role="meter" [attr.aria-valuenow]="sys.cpu.usage" aria-valuemin="0" aria-valuemax="100" [attr.aria-label]="'CPU usage ' + sys.cpu.usage + '%'">
            <div class="resource-bar">
              <div class="resource-bar__fill resource-bar__fill--cpu" [style.width.%]="sys.cpu.usage"></div>
            </div>
            <span class="resource-bar__label">{{ sys.cpu.usage }}%</span>
          </div>
        </div>
      </div>
    </section>

    <mat-divider />

    <!-- Memory -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">storage</mat-icon>
        Memory
      </h2>
      <div class="info-grid">
        <div class="info-row">
          <span class="info-label">Total</span>
          <span class="info-value">{{ formatBytes(sys.memory.total) }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Used</span>
          <span class="info-value">{{ formatBytes(sys.memory.total - sys.memory.free) }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Free</span>
          <span class="info-value">{{ formatBytes(sys.memory.free) }}</span>
        </div>
        <div class="info-row info-row--bar">
          <span class="info-label">Usage</span>
          <div class="resource-bar-wrap"
               role="meter"
               [attr.aria-valuenow]="(sys.memory.total - sys.memory.free) / sys.memory.total * 100 | number:'1.0-0'"
               aria-valuemin="0"
               aria-valuemax="100"
               [attr.aria-label]="'Memory usage ' + ((sys.memory.total - sys.memory.free) / sys.memory.total * 100 | number:'1.0-0') + '%'">
            <div class="resource-bar">
              <div class="resource-bar__fill resource-bar__fill--mem"
                   [style.width.%]="(sys.memory.total - sys.memory.free) / sys.memory.total * 100"></div>
            </div>
            <span class="resource-bar__label">{{ (sys.memory.total - sys.memory.free) / sys.memory.total * 100 | number:'1.0-0' }}%</span>
          </div>
        </div>
      </div>
    </section>

    <mat-divider />

    <!-- Disk -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">hard_drive</mat-icon>
        Storage
      </h2>
      <div class="disk-list">
        @for (disk of sys.disks; track disk.mount) {
          <div class="disk-card">
            <div class="disk-card__header">
              <mat-icon class="disk-card__icon" aria-hidden="true">hard_drive</mat-icon>
              <span class="disk-card__mount">{{ disk.mount }}</span>
              <span class="disk-card__size">{{ formatBytes(disk.total) }}</span>
            </div>
            <div class="resource-bar-wrap"
                 role="meter"
                 [attr.aria-valuenow]="(disk.total - disk.free) / disk.total * 100 | number:'1.0-0'"
                 aria-valuemin="0" aria-valuemax="100"
                 [attr.aria-label]="disk.mount + ' usage ' + ((disk.total - disk.free) / disk.total * 100 | number:'1.0-0') + '%'">
              <div class="resource-bar">
                <div class="resource-bar__fill resource-bar__fill--disk"
                     [style.width.%]="(disk.total - disk.free) / disk.total * 100"></div>
              </div>
              <span class="resource-bar__label">{{ (disk.total - disk.free) / disk.total * 100 | number:'1.0-0' }}%</span>
            </div>
            <div class="disk-card__detail">
              <span>Used: {{ formatBytes(disk.total - disk.free) }}</span>
              <span>Free: {{ formatBytes(disk.free) }}</span>
            </div>
          </div>
        }
      </div>
    </section>

    <mat-divider />

    <!-- Network -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">wifi</mat-icon>
        Network
      </h2>
      <div class="network-list">
        @for (iface of sys.network; track iface.address) {
          <div class="network-card">
            <div class="network-card__header">
              <mat-icon class="network-card__icon" aria-hidden="true">lan</mat-icon>
              <span class="network-card__name">{{ iface.name }}</span>
              <span class="network-card__family">IPv{{ iface.family === 'IPv4' ? '4' : '6' }}</span>
            </div>
            <div class="network-card__detail">
              <span class="network-card__detail-label">IP</span>
              <span class="network-card__detail-value">{{ iface.address }}</span>
            </div>
            <div class="network-card__detail">
              <span class="network-card__detail-label">MAC</span>
              <span class="network-card__detail-value">{{ iface.mac }}</span>
            </div>
          </div>
        }
      </div>
    </section>

    <mat-divider />

    <!-- Runtime Versions -->
    <section class="about-section">
      <h2 class="about-section-title">
        <mat-icon aria-hidden="true">hub</mat-icon>
        Runtime
      </h2>
      <div class="info-grid">
        <div class="info-row">
          <span class="info-label">Electron</span>
          <span class="info-value">v{{ sys.versions.electron }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Chromium</span>
          <span class="info-value">v{{ sys.versions.chrome }}</span>
        </div>
        <div class="info-row">
          <span class="info-label">Node.js</span>
          <span class="info-value">v{{ sys.versions.node }}</span>
        </div>
      </div>
    </section>

  }

  <mat-divider />
  <section class="about-section about-copilot">
    <p class="copilot-text">
      <span class="copilot-label">Built with</span>
      <svg class="copilot-icon" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 2C6.477 2 2 6.477 2 12c0 4.236 2.636 7.855 6.356 9.312-.088-.791-.167-2.005.035-2.868.181-.78 1.172-4.97 1.172-4.97s-.299-.598-.299-1.482c0-1.388.806-2.428 1.808-2.428.853 0 1.267.641 1.267 1.408 0 .858-.546 2.141-.828 3.329-.236.995.499 1.806 1.476 1.806 1.772 0 3.138-1.868 3.138-4.566 0-2.387-1.715-4.055-4.163-4.055-2.836 0-4.5 2.126-4.5 4.323 0 .856.33 1.772.741 2.273a.3.3 0 0 1 .069.282c-.075.314-.243.995-.276 1.134-.044.183-.146.222-.337.134-1.249-.581-2.03-2.407-2.03-3.874 0-3.154 2.292-6.052 6.608-6.052 3.469 0 6.165 2.473 6.165 5.776 0 3.447-2.173 6.22-5.19 6.22-1.013 0-1.966-.527-2.292-1.148l-.623 2.378c-.226.869-.835 1.958-1.244 2.621.937.29 1.931.446 2.962.446 5.523 0 10-4.477 10-10S17.523 2 12 2"/>
      </svg>
      <strong>GitHub Copilot</strong>
      <span class="copilot-sublabel">â€” AI-powered coding assistant</span>
    </p>
  </section>

  <mat-divider />

  <!-- Footer -->
  <footer class="about-footer">
    <mat-icon aria-hidden="true" class="footer-icon">copyright</mat-icon>
    <span>{{ buildYear }} {{ config.appName }}. Released under the <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer" class="footer-link">MIT License</a>.</span>
  </footer>

</div>
